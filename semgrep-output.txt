                    
                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 29 Code Findings â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              
  [36m[22m[24m  app/routes/contributions.js[0m
    â¯â± javascript.browser.security.eval-detected.eval-detected
          Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this 
          content can be input from outside the program, this may be a code injection vulnerability. Ensure
          evaluated content is not definable by external sources.                                          
          Details: https://sg.run/7ope                                                                     
                                                                                                           
           32â”† const preTax = eval(req.body.preTax);
   
   â¯â¯â± javascript.lang.security.audit.code-string-concat.code-string-concat
          Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable
          this can lead to execution of arbitrary system commands in the context of your application process.
          Avoid `eval` whenever possible.                                                                    
          Details: https://sg.run/96Yk                                                                       
                                                                                                             
           32â”† const preTax = eval(req.body.preTax);
   
    â¯â± javascript.browser.security.eval-detected.eval-detected
          Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this 
          content can be input from outside the program, this may be a code injection vulnerability. Ensure
          evaluated content is not definable by external sources.                                          
          Details: https://sg.run/7ope                                                                     
                                                                                                           
           33â”† const afterTax = eval(req.body.afterTax);
   
   â¯â¯â± javascript.lang.security.audit.code-string-concat.code-string-concat
          Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable
          this can lead to execution of arbitrary system commands in the context of your application process.
          Avoid `eval` whenever possible.                                                                    
          Details: https://sg.run/96Yk                                                                       
                                                                                                             
           33â”† const afterTax = eval(req.body.afterTax);
   
    â¯â± javascript.browser.security.eval-detected.eval-detected
          Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this 
          content can be input from outside the program, this may be a code injection vulnerability. Ensure
          evaluated content is not definable by external sources.                                          
          Details: https://sg.run/7ope                                                                     
                                                                                                           
           34â”† const roth = eval(req.body.roth);
   
   â¯â¯â± javascript.lang.security.audit.code-string-concat.code-string-concat
          Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable
          this can lead to execution of arbitrary system commands in the context of your application process.
          Avoid `eval` whenever possible.                                                                    
          Details: https://sg.run/96Yk                                                                       
                                                                                                             
           34â”† const roth = eval(req.body.roth);
                                      
  [36m[22m[24m  app/routes/index.js[0m
    â¯â± javascript.express.security.audit.express-open-redirect.express-open-redirect
          The application redirects to a URL specified by user-supplied input `req` that is not validated.   
          This could redirect users to malicious locations. Consider using an allow-list approach to validate
          URLs, or warn users they are being redirected to a third-party website.                            
          Details: https://sg.run/EpoP                                                                       
                                                                                                             
           72â”† return res.redirect(req.query.url);
                                          
  [36m[22m[24m  app/views/benefits.html[0m
    â¯â± python.django.security.django-no-csrf-token.django-no-csrf-token
          Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.
          Details: https://sg.run/N0Bp                                                                   
                                                                                                         
           54â”† <form method="POST" action="/benefits">
           55â”†     <div class="input-group">
           56â”†         <input type="hidden" name="userId" value="{{user._id.toString()}}"></input>
           57â”†         <input type="date" class="form-control" name="benefitStartDate"
               value="{{user.benefitStartDate}}"></input>                             
           58â”†         <span class="input-group-btn">
           59â”†             <button type="submit" class="btn btn-default">Save</button>
           60â”†         </span>
           61â”†     </div>
           62â”†     <!-- /input-group -->
           63â”† </form>
                                       
  [36m[22m[24m  app/views/login.html[0m
    â¯â± python.django.security.django-no-csrf-token.django-no-csrf-token
          Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.
          Details: https://sg.run/N0Bp                                                                   
                                                                                                         
          107â”† <form method="post" role="form" method="post" id="loginform">
          108â”†     <div class="form-group">
          109â”†         <label for="userName">User Name</label>
          110â”†         <input type="text" class="form-control" id="userName" name="userName"
               value="{{userName}}" placeholder="Enter User Name">                          
          111â”†     </div>
          112â”†
          113â”†     <div class="form-group">
          114â”†         <label for="password">Password</label>
          115â”†         <input type="password" class="form-control" id="password" name="password"
               value="{{password}}" placeholder="Enter Password">                               
          116â”†     </div>
             [hid 11 additional lines, adjust with --max-lines-per-finding] 
                                       
  [36m[22m[24m  app/views/memos.html[0m
    â¯â± python.django.security.django-no-csrf-token.django-no-csrf-token
          Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.
          Details: https://sg.run/N0Bp                                                                   
                                                                                                         
           15â”† <form action="/memos" method="post" role="search">
           16â”†
           17â”†     <div class="form-group">
           18â”†         <textarea class="form-control" name="memo"></textarea>
           19â”†         <p class="help-block">You may use Markdown syntax to format your memo</p>
           20â”†     </div>
           21â”†
           22â”†     <button type="submit" class="btn btn-primary">Submit</button>
           23â”† </form>
                                             
  [36m[22m[24m  app/views/tutorial/a2.html[0m
    â¯â± html.security.plaintext-http-link.plaintext-http-link
          This link points to a plaintext HTTP URL. Prefer an encrypted HTTPS URL if possible.
          Details: https://sg.run/RA5q                                                        
                                                                                              
          207â”† <li><a href="http://recxltd.blogspot.sg/2012/03/seven-web-server-http-headers-             
               that.html">Seven Web Server HTTP Headers that Improve Web Application Security for Free</a>
            â‹®â”†----------------------------------------
          209â”† <li><a href="http://passportjs.org/guide/authenticate/">Passport</a> authentication
               middleware</li>                                                                    
            â‹®â”†----------------------------------------
          210â”† <li><a href="http://en.wikipedia.org/wiki/Session_fixation">CWE-384: Session Fixation</a>
                                             
  [36m[22m[24m  app/views/tutorial/a5.html[0m
    â¯â± html.security.plaintext-http-link.plaintext-http-link
          This link points to a plaintext HTTP URL. Prefer an encrypted HTTPS URL if possible.
          Details: https://sg.run/RA5q                                                        
                                                                                              
           50â”† Use latest stable version of node.js and express (or other web framework you are using).
               Keep a watch on published vulnerabilities of these. The vulnerabilities for node.js and 
               express.js can be found <a href="http://blog.nodejs.org/vulnerability/">here</a> and    
            â‹®â”†----------------------------------------
           51â”† <a href="http://expressjs.com/advanced/security-updates.html">here</a>, respectively.
                                            
  [36m[22m[24m  artifacts/cert/server.key[0m
   â¯â¯â± generic.secrets.security.detected-private-key.detected-private-key
          Private Key detected. This is a sensitive credential and should not be hardcoded here. Instead,
          store this in a separate, private file.                                                        
          Details: https://sg.run/b7dr                                                                   
                                                                                                         
            1â”† -----BEGIN RSA PRIVATE KEY-----
            2â”† MIICXgIBAAKBgQCfn8uP4FuHaaAPrMkcl1fNMQM5EGMT4nnNSVoaEVdiDLc6P0mC
                                        
  [36m[22m[24m  artifacts/db-reset.js[0m
   â¯â¯â± generic.secrets.security.detected-bcrypt-hash.detected-bcrypt-hash
          bcrypt hash detected        
          Details: https://sg.run/3A8G
                                      
           19â”† //"password" : "$2a$10$8Zo/1e8KM8QzqOKqbDlYlONBOzukWXrM.IiyzqHRYDXqwB3gzDsba", // Admin_123
            â‹®â”†----------------------------------------
           28â”† // "password" : "$2a$10$RNFhiNmt2TTpVO9cqZElb.LQM9e1mzDoggEHufLjAnAKImc6FNE86",// User1_123
            â‹®â”†----------------------------------------
           36â”† //"password" : "$2a$10$Tlx2cNv15M0Aia7wyItjsepeA8Y6PyBYaNdQqvpxkIUlcONf1ZHyq", // User2_123
                                     
  [36m[22m[24m  docker-compose.yml[0m
    â¯â± yaml.docker-compose.security.no-new-privileges.no-new-privileges
          Service 'mongo' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-
          privileges:true' in 'security_opt' to prevent this.                                        
          Details: https://sg.run/0n8q                                                               
                                                                                                     
           13â”† mongo:
   
    â¯â± yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service
          Service 'mongo' is running with a writable root filesystem. This may allow malicious applications to
          download and run additional payloads, or modify container files. If an application inside a         
          container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this   
          service to prevent this.                                                                            
          Details: https://sg.run/e4JE                                                                        
                                                                                                              
           13â”† mongo:
                            
  [36m[22m[24m  server.js[0m
     â± javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage
          A CSRF middleware was not detected in your express application. Ensure you are either using one such
          as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your    
          routes with a token or cookies.                                                                     
          Details: https://sg.run/BxzR                                                                        
                                                                                                              
           15â”† const app = express(); // Web framework to handle routing requests
   
    â¯â± javascript.express.security.audit.express-cookie-settings.express-cookie-session-default-name
          Donâ€™t use the default session cookie name Using the default session cookie name can open your app to
          attacks. The security issue posed is similar to X-Powered-By: a potential attacker can use it to    
          fingerprint the server and target attacks accordingly.                                              
          Details: https://sg.run/1Z5x                                                                        
                                                                                                              
           78â”† app.use(session({
           79â”†     // genid: (req) => {
           80â”†     //    return genuuid() // use UUIDs for session IDs
           81â”†     //},
           82â”†     secret: cookieSecret,
           83â”†     // Both mandatory in Express v4
           84â”†     saveUninitialized: true,
           85â”†     resave: true
           86â”†     /*
           87â”†     // Fix for A5 - Security MisConfig
             [hid 15 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain
          Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it
          to compare against the domain of the server in which the URL is being requested. If they match, then
          check the path attribute next.                                                                      
          Details: https://sg.run/rd41                                                                        
                                                                                                              
           78â”† app.use(session({
           79â”†     // genid: (req) => {
           80â”†     //    return genuuid() // use UUIDs for session IDs
           81â”†     //},
           82â”†     secret: cookieSecret,
           83â”†     // Both mandatory in Express v4
           84â”†     saveUninitialized: true,
           85â”†     resave: true
           86â”†     /*
           87â”†     // Fix for A5 - Security MisConfig
             [hid 15 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires
          Default session middleware settings: `expires` not set. Use it to set expiration date for persistent
          cookies.                                                                                            
          Details: https://sg.run/N4eG                                                                        
                                                                                                              
           78â”† app.use(session({
           79â”†     // genid: (req) => {
           80â”†     //    return genuuid() // use UUIDs for session IDs
           81â”†     //},
           82â”†     secret: cookieSecret,
           83â”†     // Both mandatory in Express v4
           84â”†     saveUninitialized: true,
           85â”†     resave: true
           86â”†     /*
           87â”†     // Fix for A5 - Security MisConfig
             [hid 15 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly
          Default session middleware settings: `httpOnly` not set. It ensures the cookie is sent only over
          HTTP(S), not client JavaScript, helping to protect against cross-site scripting attacks.        
          Details: https://sg.run/ydBO                                                                    
                                                                                                          
           78â”† app.use(session({
           79â”†     // genid: (req) => {
           80â”†     //    return genuuid() // use UUIDs for session IDs
           81â”†     //},
           82â”†     secret: cookieSecret,
           83â”†     // Both mandatory in Express v4
           84â”†     saveUninitialized: true,
           85â”†     resave: true
           86â”†     /*
           87â”†     // Fix for A5 - Security MisConfig
             [hid 15 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-path
          Default session middleware settings: `path` not set. It indicates the path of the cookie; use it to
          compare against the request path. If this and domain match, then send the cookie in the request.   
          Details: https://sg.run/b7pd                                                                       
                                                                                                             
           78â”† app.use(session({
           79â”†     // genid: (req) => {
           80â”†     //    return genuuid() // use UUIDs for session IDs
           81â”†     //},
           82â”†     secret: cookieSecret,
           83â”†     // Both mandatory in Express v4
           84â”†     saveUninitialized: true,
           85â”†     resave: true
           86â”†     /*
           87â”†     // Fix for A5 - Security MisConfig
             [hid 15 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure
          Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie
          over HTTPS.                                                                                        
          Details: https://sg.run/9oKz                                                                       
                                                                                                             
           78â”† app.use(session({
           79â”†     // genid: (req) => {
           80â”†     //    return genuuid() // use UUIDs for session IDs
           81â”†     //},
           82â”†     secret: cookieSecret,
           83â”†     // Both mandatory in Express v4
           84â”†     saveUninitialized: true,
           85â”†     resave: true
           86â”†     /*
           87â”†     // Fix for A5 - Security MisConfig
             [hid 15 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± problem-based-packs.insecure-transport.js-node.using-http-server.using-http-server
          Checks for any usage of http servers instead of https servers. Encourages the usage of https       
          protocol instead of http, which does not have TLS and is therefore unencrypted. Using http can lead
          to man-in-the-middle attacks in which the attacker is able to read sensitive information.          
          Details: https://sg.run/x1zL                                                                       
                                                                                                             
          145â”† http.createServer(app).listen(port, () => {

